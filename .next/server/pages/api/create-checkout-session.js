/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(function() {
var exports = {};
exports.id = "pages/api/create-checkout-session";
exports.ids = ["pages/api/create-checkout-session"];
exports.modules = {

/***/ "./src/pages/api/create-checkout-session.js":
/*!**************************************************!*\
  !*** ./src/pages/api/create-checkout-session.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n//everything in api, is backend code\n// the secret key is have to be kept secret\nconst stripe = __webpack_require__(/*! stripe */ \"stripe\")(process.env.STRIPE_SECRET_KEY); // then we get request, we access the items\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (async (req, res) => {\n  // this is going to be called then we his this endpoint  .../api-create-checkout-session\n  // this will pull out this data from the request body\n  const {\n    items,\n    email\n  } = req.body;\n  console.log(items);\n  console.log(email); // now we need to transform this array to the data format, which stripe could make a product from\n  // for every single item we make the return\n\n  const transformedItems = items.map(item => ({\n    // taking each item, and shaping it to make it to be accepted by stripe, to create the products\n    description: item.description,\n    // now it is the flat one, but if we add something like groups, we have to make something differetn\n    quantity: 1,\n    price_data: {\n      currency: \"USD\",\n      // they take currency in subunits in cents meaning\n      unit_amount: item.price * 100,\n      product_data: {\n        name: item.title,\n        images: [item.image]\n      }\n    }\n  })); //creates the checkout page in here\n\n  const session = await stripe.checkout.sessions.create({\n    // checkout page initializes in here\n    // defining the whole page\n    payment_method_types: [\"card\"],\n    // shipping rates in here\n    shipping_rates: ['shr_1IwLJLGdDXxRlQhYTmFcIKcE'],\n    shipping_address_collection: {\n      // shipping location\n      // to this countries we are going to ship too!\n      allowed_countries: ['GB', 'US', 'CA']\n    },\n    // all the items, we are going to have in that page\n    line_items: transformedItems,\n    // the mode is payment\n    mode: 'payment',\n    // success and cancel urls goes in here\n    success_url: `${process.env.HOST}/success`,\n    cancel_url: `${process.env.HOST}/checkout`,\n    // metadata could be anything, in this case, eamil and images\n    metadata: {\n      email,\n      // we send in json, because it is much easier to send the complicated object in text, than in some kind of any other format\n      // makes the array of strings\n      images: JSON.stringify(items.map(item => item.image))\n    }\n  }); // 200 is ok\n  /// we create a checkoupage with a session id, then we get back the session id in json\n\n  res.status(200).json({\n    id: session.id\n  });\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aXRoLXJlZHV4LXRvb2xraXQvLi9zcmMvcGFnZXMvYXBpL2NyZWF0ZS1jaGVja291dC1zZXNzaW9uLmpzPzg3M2IiXSwibmFtZXMiOlsic3RyaXBlIiwicmVxdWlyZSIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfU0VDUkVUX0tFWSIsInJlcSIsInJlcyIsIml0ZW1zIiwiZW1haWwiLCJib2R5IiwiY29uc29sZSIsImxvZyIsInRyYW5zZm9ybWVkSXRlbXMiLCJtYXAiLCJpdGVtIiwiZGVzY3JpcHRpb24iLCJxdWFudGl0eSIsInByaWNlX2RhdGEiLCJjdXJyZW5jeSIsInVuaXRfYW1vdW50IiwicHJpY2UiLCJwcm9kdWN0X2RhdGEiLCJuYW1lIiwidGl0bGUiLCJpbWFnZXMiLCJpbWFnZSIsInNlc3Npb24iLCJjaGVja291dCIsInNlc3Npb25zIiwiY3JlYXRlIiwicGF5bWVudF9tZXRob2RfdHlwZXMiLCJzaGlwcGluZ19yYXRlcyIsInNoaXBwaW5nX2FkZHJlc3NfY29sbGVjdGlvbiIsImFsbG93ZWRfY291bnRyaWVzIiwibGluZV9pdGVtcyIsIm1vZGUiLCJzdWNjZXNzX3VybCIsIkhPU1QiLCJjYW5jZWxfdXJsIiwibWV0YWRhdGEiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdHVzIiwianNvbiIsImlkIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBLE1BQU1BLE1BQU0sR0FBR0MsbUJBQU8sQ0FBQyxzQkFBRCxDQUFQLENBQWtCQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsaUJBQTlCLENBQWYsQyxDQUNBOzs7QUFFQSwrREFBZSxPQUFPQyxHQUFQLEVBQVlDLEdBQVosS0FBb0I7QUFDL0I7QUFDQTtBQUNBLFFBQU07QUFBQ0MsU0FBRDtBQUFRQztBQUFSLE1BQWlCSCxHQUFHLENBQUNJLElBQTNCO0FBQ0FDLFNBQU8sQ0FBQ0MsR0FBUixDQUFZSixLQUFaO0FBQ0FHLFNBQU8sQ0FBQ0MsR0FBUixDQUFZSCxLQUFaLEVBTCtCLENBTS9CO0FBQ0E7O0FBQ0EsUUFBTUksZ0JBQWdCLEdBQUdMLEtBQUssQ0FBQ00sR0FBTixDQUFVQyxJQUFJLEtBQUs7QUFDeEM7QUFDQUMsZUFBVyxFQUFFRCxJQUFJLENBQUNDLFdBRnNCO0FBR3hDO0FBQ0FDLFlBQVEsRUFBRSxDQUo4QjtBQUt4Q0MsY0FBVSxFQUFFO0FBQ1JDLGNBQVEsRUFBRSxLQURGO0FBRVI7QUFDQUMsaUJBQVcsRUFBR0wsSUFBSSxDQUFDTSxLQUFMLEdBQWEsR0FIbkI7QUFJUkMsa0JBQVksRUFBRTtBQUNWQyxZQUFJLEVBQUVSLElBQUksQ0FBQ1MsS0FERDtBQUVWQyxjQUFNLEVBQUUsQ0FBQ1YsSUFBSSxDQUFDVyxLQUFOO0FBRkU7QUFKTjtBQUw0QixHQUFMLENBQWQsQ0FBekIsQ0FSK0IsQ0F3Qi9COztBQUNBLFFBQU1DLE9BQU8sR0FBRyxNQUFNMUIsTUFBTSxDQUFDMkIsUUFBUCxDQUFnQkMsUUFBaEIsQ0FBeUJDLE1BQXpCLENBQWdDO0FBQ3BEO0FBQ0U7QUFDQUMsd0JBQW9CLEVBQUUsQ0FBQyxNQUFELENBSDRCO0FBSWxEO0FBQ0FDLGtCQUFjLEVBQUUsQ0FBQyw4QkFBRCxDQUxrQztBQU1sREMsK0JBQTJCLEVBQUU7QUFDekI7QUFDQTtBQUNBQyx1QkFBaUIsRUFBRSxDQUFDLElBQUQsRUFBTyxJQUFQLEVBQWEsSUFBYjtBQUhNLEtBTnFCO0FBV2xEO0FBQ0FDLGNBQVUsRUFBRXRCLGdCQVpzQztBQWFsRDtBQUNBdUIsUUFBSSxFQUFFLFNBZDRDO0FBZWxEO0FBQ0FDLGVBQVcsRUFBRyxHQUFFbEMsT0FBTyxDQUFDQyxHQUFSLENBQVlrQyxJQUFLLFVBaEJpQjtBQWlCbERDLGNBQVUsRUFBRyxHQUFFcEMsT0FBTyxDQUFDQyxHQUFSLENBQVlrQyxJQUFLLFdBakJrQjtBQWtCbEQ7QUFDQUUsWUFBUSxFQUFFO0FBQ04vQixXQURNO0FBRU47QUFDQTtBQUNBZ0IsWUFBTSxFQUFFZ0IsSUFBSSxDQUFDQyxTQUFMLENBQWVsQyxLQUFLLENBQUNNLEdBQU4sQ0FBV0MsSUFBRCxJQUFVQSxJQUFJLENBQUNXLEtBQXpCLENBQWY7QUFKRjtBQW5Cd0MsR0FBaEMsQ0FBdEIsQ0F6QitCLENBb0QvQjtBQUNBOztBQUNBbkIsS0FBRyxDQUFDb0MsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVDLE1BQUUsRUFBRWxCLE9BQU8sQ0FBQ2tCO0FBQWQsR0FBckI7QUFDSCxDQXZERCIsImZpbGUiOiIuL3NyYy9wYWdlcy9hcGkvY3JlYXRlLWNoZWNrb3V0LXNlc3Npb24uanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2V2ZXJ5dGhpbmcgaW4gYXBpLCBpcyBiYWNrZW5kIGNvZGVcbi8vIHRoZSBzZWNyZXQga2V5IGlzIGhhdmUgdG8gYmUga2VwdCBzZWNyZXRcbmNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoJ3N0cmlwZScpKHByb2Nlc3MuZW52LlNUUklQRV9TRUNSRVRfS0VZKTtcbi8vIHRoZW4gd2UgZ2V0IHJlcXVlc3QsIHdlIGFjY2VzcyB0aGUgaXRlbXNcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgLy8gdGhpcyBpcyBnb2luZyB0byBiZSBjYWxsZWQgdGhlbiB3ZSBoaXMgdGhpcyBlbmRwb2ludCAgLi4uL2FwaS1jcmVhdGUtY2hlY2tvdXQtc2Vzc2lvblxuICAgIC8vIHRoaXMgd2lsbCBwdWxsIG91dCB0aGlzIGRhdGEgZnJvbSB0aGUgcmVxdWVzdCBib2R5XG4gICAgY29uc3Qge2l0ZW1zLCBlbWFpbH0gPSByZXEuYm9keTtcbiAgICBjb25zb2xlLmxvZyhpdGVtcyk7XG4gICAgY29uc29sZS5sb2coZW1haWwpO1xuICAgIC8vIG5vdyB3ZSBuZWVkIHRvIHRyYW5zZm9ybSB0aGlzIGFycmF5IHRvIHRoZSBkYXRhIGZvcm1hdCwgd2hpY2ggc3RyaXBlIGNvdWxkIG1ha2UgYSBwcm9kdWN0IGZyb21cbiAgICAvLyBmb3IgZXZlcnkgc2luZ2xlIGl0ZW0gd2UgbWFrZSB0aGUgcmV0dXJuXG4gICAgY29uc3QgdHJhbnNmb3JtZWRJdGVtcyA9IGl0ZW1zLm1hcChpdGVtID0+ICh7XG4gICAgICAgIC8vIHRha2luZyBlYWNoIGl0ZW0sIGFuZCBzaGFwaW5nIGl0IHRvIG1ha2UgaXQgdG8gYmUgYWNjZXB0ZWQgYnkgc3RyaXBlLCB0byBjcmVhdGUgdGhlIHByb2R1Y3RzXG4gICAgICAgIGRlc2NyaXB0aW9uOiBpdGVtLmRlc2NyaXB0aW9uLFxuICAgICAgICAvLyBub3cgaXQgaXMgdGhlIGZsYXQgb25lLCBidXQgaWYgd2UgYWRkIHNvbWV0aGluZyBsaWtlIGdyb3Vwcywgd2UgaGF2ZSB0byBtYWtlIHNvbWV0aGluZyBkaWZmZXJldG5cbiAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIHByaWNlX2RhdGE6IHtcbiAgICAgICAgICAgIGN1cnJlbmN5OiBcIlVTRFwiLFxuICAgICAgICAgICAgLy8gdGhleSB0YWtlIGN1cnJlbmN5IGluIHN1YnVuaXRzIGluIGNlbnRzIG1lYW5pbmdcbiAgICAgICAgICAgIHVuaXRfYW1vdW50OiAgaXRlbS5wcmljZSAqIDEwMCxcbiAgICAgICAgICAgIHByb2R1Y3RfZGF0YToge1xuICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0udGl0bGUsXG4gICAgICAgICAgICAgICAgaW1hZ2VzOiBbaXRlbS5pbWFnZV1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSkpO1xuXG4gICAgLy9jcmVhdGVzIHRoZSBjaGVja291dCBwYWdlIGluIGhlcmVcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgc3RyaXBlLmNoZWNrb3V0LnNlc3Npb25zLmNyZWF0ZSh7XG4gICAgICAvLyBjaGVja291dCBwYWdlIGluaXRpYWxpemVzIGluIGhlcmVcbiAgICAgICAgLy8gZGVmaW5pbmcgdGhlIHdob2xlIHBhZ2VcbiAgICAgICAgcGF5bWVudF9tZXRob2RfdHlwZXM6IFtcImNhcmRcIl0sXG4gICAgICAgIC8vIHNoaXBwaW5nIHJhdGVzIGluIGhlcmVcbiAgICAgICAgc2hpcHBpbmdfcmF0ZXM6IFsnc2hyXzFJd0xKTEdkRFh4UmxRaFlUbUZjSUtjRSddLFxuICAgICAgICBzaGlwcGluZ19hZGRyZXNzX2NvbGxlY3Rpb246IHtcbiAgICAgICAgICAgIC8vIHNoaXBwaW5nIGxvY2F0aW9uXG4gICAgICAgICAgICAvLyB0byB0aGlzIGNvdW50cmllcyB3ZSBhcmUgZ29pbmcgdG8gc2hpcCB0b28hXG4gICAgICAgICAgICBhbGxvd2VkX2NvdW50cmllczogWydHQicsICdVUycsICdDQSddLFxuICAgICAgICB9LFxuICAgICAgICAvLyBhbGwgdGhlIGl0ZW1zLCB3ZSBhcmUgZ29pbmcgdG8gaGF2ZSBpbiB0aGF0IHBhZ2VcbiAgICAgICAgbGluZV9pdGVtczogdHJhbnNmb3JtZWRJdGVtcyxcbiAgICAgICAgLy8gdGhlIG1vZGUgaXMgcGF5bWVudFxuICAgICAgICBtb2RlOiAncGF5bWVudCcsXG4gICAgICAgIC8vIHN1Y2Nlc3MgYW5kIGNhbmNlbCB1cmxzIGdvZXMgaW4gaGVyZVxuICAgICAgICBzdWNjZXNzX3VybDogYCR7cHJvY2Vzcy5lbnYuSE9TVH0vc3VjY2Vzc2AsXG4gICAgICAgIGNhbmNlbF91cmw6IGAke3Byb2Nlc3MuZW52LkhPU1R9L2NoZWNrb3V0YCxcbiAgICAgICAgLy8gbWV0YWRhdGEgY291bGQgYmUgYW55dGhpbmcsIGluIHRoaXMgY2FzZSwgZWFtaWwgYW5kIGltYWdlc1xuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICAvLyB3ZSBzZW5kIGluIGpzb24sIGJlY2F1c2UgaXQgaXMgbXVjaCBlYXNpZXIgdG8gc2VuZCB0aGUgY29tcGxpY2F0ZWQgb2JqZWN0IGluIHRleHQsIHRoYW4gaW4gc29tZSBraW5kIG9mIGFueSBvdGhlciBmb3JtYXRcbiAgICAgICAgICAgIC8vIG1ha2VzIHRoZSBhcnJheSBvZiBzdHJpbmdzXG4gICAgICAgICAgICBpbWFnZXM6IEpTT04uc3RyaW5naWZ5KGl0ZW1zLm1hcCgoaXRlbSkgPT4gaXRlbS5pbWFnZSkpLFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gMjAwIGlzIG9rXG4gICAgLy8vIHdlIGNyZWF0ZSBhIGNoZWNrb3VwYWdlIHdpdGggYSBzZXNzaW9uIGlkLCB0aGVuIHdlIGdldCBiYWNrIHRoZSBzZXNzaW9uIGlkIGluIGpzb25cbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlkOiBzZXNzaW9uLmlkIH0pXG59O1xuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/pages/api/create-checkout-session.js\n");

/***/ }),

/***/ "stripe":
/*!*************************!*\
  !*** external "stripe" ***!
  \*************************/
/***/ (function(module) {

"use strict";
module.exports = require("stripe");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }
var __webpack_exports__ = (__webpack_exec__("./src/pages/api/create-checkout-session.js"));
module.exports = __webpack_exports__;

})();